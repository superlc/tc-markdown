# Design: optimize-strikethrough-streaming

## Context
项目已有 `InlineCompleter` 用于在流式渲染中预测补全未闭合的行内标记（含删除线 `~~`）。
当前问题表现为：当删除线从“未闭合/不完整”逐步变为“可闭合/可识别”时，UI 会先以纯文本显示删除线内容，随后突然切换为 `<del>`，造成闪现。

## Approach
- 优先通过改进“删除线预测补全的触发时机与边界处理”来消除闪现。
- 关键原则：一旦 `~~` 被判定为删除线开始标记，后续字符应尽量被包裹在预测的删除线结构中呈现（即预测补全闭合），从而避免回溯转换。

## Edge Cases
- chunk 边界切在 `~`/`~~` 中间（例如第一帧末尾只有 `~` 或 `~~`）。
- chunk 边界切在删除线内容中间（例如 `这是~~删`）。
- chunk 边界切在闭合 `~~` 中间（例如 `这是~~删除~` + `~`）。

## Trade-offs
- 预测补全可能需要插入不可见字符（例如 ZWSP）以稳定解析器行为，但必须确保最终完成态不污染输出（完成闭合后应移除预测痕迹）。
